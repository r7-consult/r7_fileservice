# üõ†Ô∏è Free XLS FileService

**Free XLS FileService** ‚Äî —ç—Ç–æ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π –≤–µ–±-—Å–µ—Ä–≤–∏—Å –¥–ª—è –Ω–µ–∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ Excel-—Ñ–∞–π–ª–æ–≤ –∫–∞–∫ —Å SQL-—Ç–∞–±–ª–∏—Ü–∞–º–∏. –° –µ–≥–æ –ø–æ–º–æ—â—å—é –º–æ–∂–Ω–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –¥–∞–Ω–Ω—ã–º Excel —á–µ—Ä–µ–∑ web API, –æ—Ç–ø—Ä–∞–≤–ª—è—è GET-–∑–∞–ø—Ä–æ—Å—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑ –º–∞–∫—Ä–æ—Å–æ–≤ –†7-–û—Ñ–∏—Å.


## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤

```bash
git clone https://github.com/r7-consult/r7_fileservice.git
cd r7_fileservice
pip install -r requirements.txt
python -m xldb-proxy-file
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ó–∞–ø—É—Å–∫ –∏–∑ –≥–æ—Ç–æ–≤–æ–π —Å–±–æ—Ä–∫–∏

–°–∫–∞—á–∞–π—Ç–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –¥–ª—è –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã:
- <a href="./build/r7_fileservice-windows.exe" download>‚¨á Windows</a>
- <a href="./build/r7_fileservice-ubuntu.bin" download>‚¨á Ubuntu</a>
- <a href="./build/r7_fileservice-redos.bin" download>‚¨á RedOS</a>
- <a href="./build/r7_fileservice-astra.bin" download>‚¨á AstraOS</a>

–ó–∞—Ç–µ–º –ø—Ä–æ—Å—Ç–æ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
./r7_fileservice-[os] //–∑–∞–ø—É—Å—Ç–∏—Ç–µ –Ω—É–∂–Ω—ã–π –±–∏–ª–¥
``` 
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ http://127.0.0.1:58081

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã

### GET /file/list
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
```bash
http://localhost:58081/file/list?path=C:\
```
–û—Ç–≤–µ—Ç:
- –£—Å–ø–µ—Ö: `{"files": ["file1.xlsx", "file2.xlsx", ...]}` - —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤
- –û—à–∏–±–∫–∞: HTTP 500 —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ—à–∏–±–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)

### GET /file/available
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞
```bash
http://localhost:58081/file/available?path=C:\&file_name=example.xlsx
```
–û—Ç–≤–µ—Ç:
- –§–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: `{"status": "OK"}`
- –§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: `{"status": "Error"}`
- –û—à–∏–±–∫–∞: HTTP 500 —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ—à–∏–±–∫–∏

### GET /file/meta
–ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞
```bash
http://localhost:58081/file/meta?path=C:\&file_name=example.xlsx
```
–û—Ç–≤–µ—Ç:
- –£—Å–ø–µ—Ö: JSON —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ —Ñ–∞–π–ª–∞:
  ```json
  {
    "file_name": "example.xlsx",
    "file_path": "C:\\example.xlsx",
    "size_bytes": 1234,
    "created_at": "2025-05-20T12:00:00",
    "modified_at": "2025-05-20T12:00:00",
    "accessed_at": "2025-05-20T12:00:00",
    "mode": "0o100666",
    "sheets": ["Sheet1", "Sheet2"],
    "copyright": "Free for non commercial use https://r7-consult.ru/"
  }
  ```
- –û—à–∏–±–∫–∞: HTTP 500 —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ—à–∏–±–∫–∏

### GET /file/register
–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —á—Ç–µ–Ω–∏—è Excel-—Ñ–∞–π–ª–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –µ–≥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
```bash
http://localhost:58081/file/register?path=C:\&file_name=example.xlsx&sheet_name=Sheet1&usecols=A,B,C&skiprows=0&nrows=1000
```
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `sheet_name`: –∏–º—è –ª–∏—Å—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `usecols`: —Å–ø–∏—Å–æ–∫ –∫–æ–ª–æ–Ω–æ–∫ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `skiprows`: –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫ —Å–≤–µ—Ä—Ö—É (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0)
- `nrows`: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ —Å—Ç—Ä–æ–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10000000)

–û—Ç–≤–µ—Ç:
- –£—Å–ø–µ—Ö: `{"columns": ["col1", "col2", ...], "rows": 1000}` - —Å–ø–∏—Å–æ–∫ –∫–æ–ª–æ–Ω–æ–∫ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –≤ —Ñ–∞–π–ª–µ
- –û—à–∏–±–∫–∞: HTTP 500 —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ—à–∏–±–∫–∏

### GET /file/sql
–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL-–∑–∞–ø—Ä–æ—Å–∞ –∫ Excel-—Ñ–∞–π–ª—É
```bash
http://localhost:58081/file/sql?query=select%20*%20from%20df&path=C:\&file_name=example.xlsx&sheet_name=Sheet1
```
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- –¢–µ –∂–µ, —á—Ç–æ –∏ –¥–ª—è `/file/register`
- `query`: SQL-–∑–∞–ø—Ä–æ—Å (–¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Ç–∞–±–ª–∏—Ü–µ —Å –∏–º–µ–Ω–µ–º `df`)

–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:
```sql
select * from df                           -- –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
select col1, col2 from df                  -- —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏
select * from df where col1 > 100          -- —Å —É—Å–ª–æ–≤–∏–µ–º
select col1, count(*) from df group by col1 -- —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π
```

–û—Ç–≤–µ—Ç:
- –£—Å–ø–µ—Ö: –ú–∞—Å—Å–∏–≤ –∑–∞–ø–∏—Å–µ–π —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∑–∞–ø—Ä–æ—Å–∞
- –û—à–∏–±–∫–∞: HTTP 500 —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ—à–∏–±–∫–∏

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ –ª–∏—Å—Ç–µ –†7 —á–µ—Ä–µ–∑ –º–∞–∫—Ä–æ—Å—ã

–î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ SQL-–∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –ª–∏—Å—Ç–µ –†7-–û—Ñ–∏—Å –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –º–∞–∫—Ä–æ—Å:

```javascript
(function() {
  // URL —Å SQL-–∑–∞–ø—Ä–æ—Å–æ–º –∫ —Ñ–∞–π–ª—É Excel
  var url = "http://localhost:58081/file/sql?query=select%20*%20from%20df&path=C:\\tt&file_name=address.xlsx&sheet_name=Sheet1";

  fetch(url)
    .then(response => response.json())  // –ü–∞—Ä—Å–∏–º –æ—Ç–≤–µ—Ç –∫–∞–∫ JSON
    .then(data => {
      var oWorksheet = Api.GetActiveSheet();  // –ü–æ–ª—É—á–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –ª–∏—Å—Ç

      // –°—á–∏—Ç—ã–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ JSON
      var headers = Object.keys(data[0]);

      // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –¥–≤—É–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤ –ø–æ –ø–æ—Ä—è–¥–∫—É –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
      var sData = data.map(row => headers.map(h => row[h] || ''));

      // –û–±—ä–µ–¥–∏–Ω—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ —Å—Ç—Ä–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö
      var fullArray = [headers, ...sData];

      // –ü–æ–ª—É—á–∞–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω –¥–ª—è –≤—Å–µ–π —Ç–∞–±–ª–∏—Ü—ã
      var dataRange = oWorksheet.GetRange(
        oWorksheet.GetRangeByNumber(0, 0),
        oWorksheet.GetRangeByNumber(fullArray.length - 1, headers.length - 1)
      );

      // –í—Å—Ç–∞–≤–ª—è–µ–º –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–¥–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π
      dataRange.SetValue(fullArray);

      // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç
      Api.asc_calculate(Asc.c_oAscCalculateType.ActiveSheet);
    })
    .catch(error => {
      console.log("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö:", error);
    });
})();
```

–ú–∞–∫—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:
1. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GET-–∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–∏—Å—É —Å SQL-–∑–∞–ø—Ä–æ—Å–æ–º
2. –ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON
3. –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü—É:
   - –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ - –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫–æ–ª–æ–Ω–æ–∫
   - –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ - –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞
4. –í—Å—Ç–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –∞–∫—Ç–∏–≤–Ω—ã–π –ª–∏—Å—Ç, –Ω–∞—á–∏–Ω–∞—è —Å —è—á–µ–π–∫–∏ A1
5. –û–±–Ω–æ–≤–ª—è–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ª–∏—Å—Ç–∞

> **–í–∞–∂–Ω–æ**: –î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞–∫—Ä–æ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ `Api.asc_calculate()`, —Ç–∞–∫ –∫–∞–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –º–∞–∫—Ä–æ—Å –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
r7_fileservice/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ logger_conf.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ r7_fileservice.py
‚îÇ   ‚îú‚îÄ‚îÄ reporting.py
‚îÇ   ‚îú‚îÄ‚îÄ svc_xls_files.py
‚îÇ   ‚îî‚îÄ‚îÄ types_meta.py
‚îú‚îÄ‚îÄ build/
‚îÇ   ‚îú‚îÄ‚îÄ r7_fileservice-windows.exe
‚îÇ   ‚îú‚îÄ‚îÄ r7_fileservice-ubuntu.bin
‚îÇ   ‚îú‚îÄ‚îÄ r7_fileservice-redos.bin
‚îÇ   ‚îî‚îÄ‚îÄ r7_fileservice-astra.bin
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îî‚îÄ‚îÄ Free XLS FileService - –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è —Ä–µ—à–µ–Ω–∏—è.pdf
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```
## –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è —Ä–µ—à–µ–Ω–∏—è
 [–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è](./docs/Free XLS FileService - –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è —Ä–µ—à–µ–Ω–∏—è.pdf)

## –ö–æ–Ω—Ç–∞–∫—Ç—ã
- –°–∞–π—Ç: [–†7-–ö–æ–Ω—Å–∞–ª—Ç](https://r7-consult.ru/)
- Email: er@exceldb.pro
- –¢–µ–ª–µ—Ñ–æ–Ω: +7 915 258-0371
- Telegram: https://t.me/r7_js
